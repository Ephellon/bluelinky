# BlueLinky (Python)
An unofficial Python API wrapper for Hyundai BlueLink. This is a fork of [BlueLinky](https://github.com/Hacksore/bluelinky).

## Install

```sh
pip install .
```

## Example

### Python Imports

```python
from bluelinky import BlueLinky, Region
from bluelinky.interfaces import BlueLinkyConfig

config = BlueLinkyConfig(
   username="someguy@example.com",
   password="hunter1",
   brand="hyundai",
   region=Region.US,
   pin="1234",
)

client = BlueLinky(config)
vehicle = client.get_vehicle("5NMS55555555555555")

if vehicle:
   response = vehicle.lock()
   print(response)
```

### Debug locally (Python CLI)
Ensure you have a `config.json` that matches the structure of the following, with your account details.

```json
{
    "username": "email",
    "password": "password",
    "pin": "pin",
    "brand": "kia" or "hyundai",
    "vin": "vin",
    "useInfo": false
}
```

Run an install for all the dependencies, `pip install .` *or* `PYTHON-INSTALL.BAT`

Now you can invoke the CLI with `python -m bluelinky [-h] [--config CONFIG] [--debug] {list,status,lock,unlock,horn,flash,locate,home,start,stop} ...`

## Development
This project was translated from TypeScript into Python using Codex (AI). **Do not** use this project for any critical infrastructure.

The Python package is managed with `pyproject.toml`. Install dependencies with `pip install -e .` to get an editable environment. The code currently includes a fully ported U.S. controller and placeholder implementations for other regions; contributions to flesh out the remaining regions are welcome.

## Documentation
Checkout out the [docs](https://bluelinky.readme.io) for more info.

Important information for login problems:
- If you experience login problems, please logout from the app on your phone and login again. You might need to ' upgrade ' your account to a generic Kia/Hyundai account, or create a new password or PIN.
- After you migrated your BlueLink account to a generic Hyundai account, or your UVO account to a generic Kia account, make sure that both accounts have the same credentials (username and password) to avoid confusion in logging in.

### (**TODO**) EU specific options
EU has specific BlueLinky options :

- `language`: The language to use when login into the system, it will also change the laguage of your mobile app. `en` by default.
- `stampMode`: *Advanced* The kind of stamping mechanism to use (`LOCAL` | `DISTANT`). `DISTANT` by default. :warning: though `LOCAL` seems to work properly, it's in beta for now.
- `stampFile`: *Advanced* The `DISTANT` stamp source to use. `https://raw.githubusercontent.com/neoPix/bluelinky-stamps/master/${brand}-${appId}.v2.json` by default.

### (**TODO**) Custom Stamps
In the EU region, stamps are used to sign every API queries. These stamps have a 1 week validity. Those stamps are using a tricky algorithm and cannot be replicated by BlueLinky and have to be generated by an external solution. An http call is performed to get the existing tokens. It is possible to specify an other path using the `stampFile` option. This path can be a local file prefixed by `file://` or from any webserver.

By default the case is 24H, but it can but customized at will. A nice trick is to run you own stamp generator http server and querying it regularly (with low cache timeout) for fresh stamps.

The JSON file must respect [this format](https://github.com/neoPix/bluelinky-stamps/blob/master/kia.json).

## Supported Features
- lock
    - `python -m bluelinky lock`
- unlock
    - `python -m bluelinky unlock`
- start (with climate control)
    - `python -m bluelinky start --temp 80F --time 3 --heat defrost`
    - `python -m bluelinky start --temp 28C --time 5 --heat all`
    - `python -m bluelinky start --temp 70F`
    - `python -m bluelinky start --time 10`
    - `python -m bluelinky start --heat yes`
- stop
    - `python -m bluelinky stop`
- status (full, parsed, cached)
    - `python -m bluelinky status`
    - `python -m bluelinky status --from parsed`
    - `python -m bluelinky status --from cached`
- odometer
    - `python -m bluelinky odometer`
- location
    - `python -m bluelinky locate`
- startCharge
    - `python -m bluelinky charge`
- monthlyReport
    - `python -m bluelinky report`
- tripInfo
    - `python -m bluelinky history`
- EV: driveHistory
    - `python -m bluelinky history all`
- EV: getChargeTargets
    - `python -m bluelinky charge --targets`
- EV: setChargeLimits
    - `python -m bluelinky charge --max 80`

## Supported Regions
| [Regions](https://github.com/Hacksore/bluelinky/wiki/Regions)

## Show your support

Give a ⭐️ if this project helped you!

## Warnings

Using BlueLinky may result in draining your 12V battery when refreshing from the car too often. Make sure you have read and understood the terms of use of your Kia or Hyundai account before using BlueLinky.
